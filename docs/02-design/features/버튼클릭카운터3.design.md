# Design: 버튼클릭카운터3

## 메타데이터
- 기능명: 버튼클릭카운터3
- 날짜: 2026-02-20
- Plan 참조: docs/01-plan/features/버튼클릭카운터3.plan.md

## 컴포넌트 구조

```
src/app/counter3/
└── page.tsx          # 메인 Counter3 컴포넌트 (use client)
```

## 타입 정의

```typescript
interface Counter {
  id: number;
  name: string;
  value: number;
}

interface HistoryEntry {
  id: number;
  counterId: number;
  counterName: string;
  delta: number;
  newValue: number;
  timestamp: string; // ISO string
}
```

## 상태 설계

```typescript
// counters: localStorage('counter3-counters') 에서 초기화
const [counters, setCounters] = useState<Counter[]>(loadFromStorage);
const [step, setStep] = useState<number>(loadStep);
const [history, setHistory] = useState<HistoryEntry[]>(loadHistory);
const [showHistory, setShowHistory] = useState<boolean>(false);
const [editingId, setEditingId] = useState<number | null>(null);
const [editingName, setEditingName] = useState<string>('');
const [nextId, setNextId] = useState<number>(loadNextId);
```

## localStorage 키

| 키 | 값 | 설명 |
|----|-----|------|
| `counter3-counters` | JSON(Counter[]) | 카운터 목록 |
| `counter3-step` | number | 증감 단위 |
| `counter3-history` | JSON(HistoryEntry[]) | 클릭 히스토리 |
| `counter3-nextId` | number | 다음 카운터 ID |

## 주요 함수

### localStorage 유틸

```typescript
function loadFromStorage(): Counter[] {
  // localStorage에서 counters 읽기, 없으면 기본값 [{ id:1, name:'카운터 1', value:0 }]
}

function saveToStorage(counters: Counter[], step: number, history: HistoryEntry[], nextId: number) {
  // 모든 상태를 localStorage에 저장
}

function loadStep(): number {
  // localStorage에서 step 읽기, 없으면 1
}

function loadHistory(): HistoryEntry[] {
  // localStorage에서 history 읽기, 없으면 []
}

function loadNextId(): number {
  // localStorage에서 nextId 읽기, 없으면 2
}
```

### 카운터 조작

```typescript
const increment = (id: number) => {
  // 값 증가 + history 추가 + localStorage 저장
};

const decrement = (id: number) => {
  // 값 감소 (최소 0) + history 추가 + localStorage 저장
};

const addCounter = () => {
  // 카운터 추가 + localStorage 저장
};

const removeCounter = (id: number) => {
  // 카운터 삭제 (최소 1개 유지) + localStorage 저장
};

const resetAll = () => {
  // 전체 초기화 (localStorage 포함)
};
```

### 히스토리 관리

```typescript
const addHistory = (counter: Counter, delta: number, newValue: number) => {
  // HistoryEntry 생성, 최대 10개 유지
  const entry: HistoryEntry = {
    id: Date.now(),
    counterId: counter.id,
    counterName: counter.name,
    delta,
    newValue,
    timestamp: new Date().toISOString(),
  };
  setHistory(prev => [entry, ...prev].slice(0, 10));
};
```

## UI 레이아웃

```
┌─────────────────────────────┐
│     버튼 클릭 카운터 3       │
├─────────────────────────────┤
│  증감 단위: [1] [5] [10]    │
├─────────────────────────────┤
│ ┌─────────────────────────┐ │
│ │ 카운터 1            [✕] │ │
│ │ [-1]    [  5  ]   [+1] │ │
│ └─────────────────────────┘ │
│ ┌─────────────────────────┐ │
│ │ 카운터 2            [✕] │ │
│ │ [-1]    [  0  ]   [+1] │ │
│ └─────────────────────────┘ │
├─────────────────────────────┤
│ 합계: 5      [+ 카운터 추가]│
├─────────────────────────────┤
│ [초기화]  [히스토리 ▼]     │
├─────────────────────────────┤
│ (히스토리 펼쳐짐)           │
│ 14:32:01 카운터1 +1 → 5    │
│ 14:31:55 카운터1 +1 → 4    │
│ ...                         │
└─────────────────────────────┘
```

## 색상 테마
- 배경: `from-purple-50 to-indigo-50` (기존과 차별화)
- 카드: `white`
- 증가 버튼: `bg-indigo-500`
- 감소 버튼: `bg-red-400`
- 단위 선택 활성: `bg-indigo-500`
- 초기화: `bg-gray-200 text-gray-600`
- 히스토리 토글: `bg-purple-100 text-purple-700`

## 히스토리 항목 형식
```
[14:32:01] 카운터 1  +1 → 5
[14:31:55] 카운터 1  -1 → 4
```
- 양수 delta: 초록 텍스트
- 음수 delta: 빨간 텍스트

## 구현 순서
1. localStorage 유틸 함수 작성
2. useState 초기화 (localStorage 값으로)
3. increment/decrement에 addHistory 연동
4. useEffect로 상태 변경 시 localStorage 저장
5. 초기화 버튼 구현
6. 히스토리 패널 UI 구현
7. /counter3 라우트 등록 확인
